{% extends "base.html" %}

{% block title %}{{ title }} | MahilMart License Manager{% endblock %}
{% block body_class %}page-user-form{% endblock %}

{% block header_icon %}<i class="fas fa-user-gear"></i>{% endblock %}
{% block header_title %}{{ title }}{% endblock %}
{% block header_actions %}
  <a class="app-btn" href="{% url 'licenses:user_list' %}"><i class="fas fa-users"></i>Users</a>
  <a class="app-btn" href="{% url 'licenses:dashboard' %}"><i class="fas fa-gauge"></i>Dashboard</a>
  <form method="post" action="{% url 'licenses:logout' %}" class="header-inline-form">
    {% csrf_token %}
    <button class="app-btn" type="submit"><i class="fas fa-right-from-bracket"></i>Logout</button>
  </form>
{% endblock %}

{% block content %}
  <section class="user-form-card">
    <h1 class="user-form-title">{{ title }}</h1>

    {% if errors %}
      <div class="error-box">
        <ul>
          {% for err in errors %}
            <li>{{ err }}</li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}

    <form method="post">
      {% csrf_token %}
      <div class="user-form-grid">
        <div class="user-form-field">
          <label>Username</label>
          <input type="text" name="username" value="{{ form.username }}" required>
        </div>

        <div class="user-form-field">
          <label>Email</label>
          <input type="email" name="email" value="{{ form.email }}">
        </div>

        <div class="user-form-field">
          <label>Role</label>
          <select name="role" required>
            <option value="admin" {% if form.role == "admin" %}selected{% endif %}>Admin</option>
            <option value="supervisor" {% if form.role == "supervisor" %}selected{% endif %}>Supervisor</option>
            <option value="cashier" {% if form.role == "cashier" %}selected{% endif %}>Cashier</option>
          </select>
        </div>

        <div class="user-form-field">
          <label>Password {% if mode == "edit" %}(optional){% endif %}</label>
          <input type="password" name="password" {% if mode == "create" %}required{% endif %}>
        </div>

        <div class="user-form-field user-form-full">
          <label>Confirm Password {% if mode == "edit" %}(only if changing password){% endif %}</label>
          <input type="password" name="confirm_password" {% if mode == "create" %}required{% endif %}>
        </div>
      </div>

      <label class="user-form-check">
        <input type="checkbox" name="is_active" {% if form.is_active %}checked{% endif %}>
        <span>User is active</span>
      </label>

      <div class="user-form-actions">
        <button class="action-btn action-btn-primary" type="submit">
          <i class="fas fa-floppy-disk"></i>{{ submit_label }}
        </button>
        <a class="action-btn action-btn-light" href="{% url 'licenses:user_list' %}">
          <i class="fas fa-arrow-left"></i>Back
        </a>
      </div>
    </form>
  </section>
{% endblock %}
